# 모델링

> [김기창의 데이터 모델링 강의](https://www.google.com/search?q=%EA%B9%80%EA%B8%B0%EC%B0%BD%EC%9D%98+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EB%AA%A8%EB%8D%B8%EB%A7%81+%EA%B0%95%EC%9D%98+site%3Ahttps%3A%2F%2Fdataonair.or.kr%2F&newwindow=1&sca_esv=ea05bd65b2dab007&sxsrf=ACQVn08ek7A8IPLY0sUjzmwn8j8PebnceA%3A1713152332130&ei=TKEcZtzMB_Klvr0Pl8OFqAs&udm=&ved=0ahUKEwjcos_hpcOFAxXykq8BHZdhAbUQ4dUDCBA&uact=5&oq=%EA%B9%80%EA%B8%B0%EC%B0%BD%EC%9D%98+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EB%AA%A8%EB%8D%B8%EB%A7%81+%EA%B0%95%EC%9D%98+site%3Ahttps%3A%2F%2Fdataonair.or.kr%2F&gs_lp=Egxnd3Mtd2l6LXNlcnAiReq5gOq4sOywveydmCDrjbDsnbTthLAg66qo642466eBIOqwleydmCBzaXRlOmh0dHBzOi8vZGF0YW9uYWlyLm9yLmtyL0i3nAFQkJgBWJCYAXADeAGQAQCYAWugAWuqAQMwLjG4AQPIAQD4AQH4AQKYAgOgAhuoAhLCAgcQIxjqAhgnwgIUEAAYgAQY4wQY6QQY6gIYtALYAQHCAhAQABgDGI8BGOoCGLQC2AECmAMLugYGCAEQARgBugYGCAIQARgKkgcBM6AHLQ&sclient=gws-wiz-serp)

다음을 아는 순간에 모델링에 깨달음을 얻었다.

- 실체 엔터티
- 관계는 속성이다.
- 수학의 집합

## 엔터티 설계의 첫 관문, 실체 엔터티

실제로 보이는 것을 나타내는 데이터를 관리하는 엔터티가 **실체 엔터티**다. 데이터가 만질 수 있는 것을 나타내면 실체이다. 실체 엔터티의 예는 다음과 같다.

- 도서관, 학교, 아파트, 발전소와 같은 모든 건축물
- 사람, 개와 같은 모든 생물체
- 노트북, 책과 같은 모든 물건
- 고객, 사원, 상품 등

실체 엔터티가 아닌 것은 추상적인 것을 관리하는 엔터티다. 추상적인 것은 다시 연상되는 것과 연상되지 않는 것으로 구분된다. 연상이 되는 것의 예로는 주문, 강의, 대출이 있다. 주로 어떤 행위와 연결된다. 연상이 되지 않는 것의 예로는 환율, 과목, 상품유형이 있다.

실체 엔터티는 모델 구조적으로 최상위에 존재하기에 중요하다.

### 유사 실체 엔터티

실체 엔터티와 **유사 실체 엔터티**를 구분할 필요가 있다. 예를 들어 도서관 모델에서 책은 실체 엔터티, 도서는 유사 실체 엔터티이다. 희망도서를 신청할 때는 실제 책이 아니라 책의 개념을 신청한다.

### 실체 엔터티의 인스턴스 개수

엔터티에서 관리하고 있는 인스턴스의 개수와 실제 존재했던 실체 개수는 같다. 우리 회사의 사원이 30명이면, 사원 엔터티의 인스턴스 개수도 30개이다. 인스턴스의 상태가 바뀌거나 변경이력을 관리해야 할 때 이 개념이 중요해진다.

실체 데이터는 한 번 존재하면 계속해서 하나의 인스턴스로 존재해야 하는 데이터이다. 고객의 속성 값에 대한 변경이력 데이터가 고객의 숫자에 영향을 미치면 안 된다.

### 실체 엔터티의 주 식별자

실체 엔터티의 주 식별자에는 몇 가지 특징이 있다.

- 시간 속성이 포함되지 않는다. 한 번 없어지면 끝이다. 같은 것이 다시 생길 수는 없다.
- 인조 식별자로 설계한다.

### 엔터티 명명법

실체 엔터티의 이름은 실체라는 성격에 어울리게 명사형으로 끝나도록 붙이면 된다. '회원탈퇴'보다는 '탈퇴회원'이 어울린다.

행위 엔터티의 이름은 뒤에 '했음'을 붙여서 자연스러우면 된다. '회원탈퇴' 뒤에 '했음'을 붙이면 자연스럽다.

### 행위 엔터티보다 실체 엔터티

계좌 엔터티와 같이 실체 데이터는 어떤 행위에 의해서 생성된다. 예를 들어 계좌 개설서를 작성해서 계좌 데이터가 생성된다. 행위 엔터티만 도출하고 실체 엔터티를 도출하지 않는 것을 주의해야 한다. 만약 하나만 관리하는 게 좋다면 실체 엔터티를 사용하는 것이 좋다.

### 기준 엔터티

실체 데이터와 유사한 **기준 엔터티**는 실체나 행위 데이터의 기준이 되는 데이터를 관리한다. 업무의 기준이 되는 데이터를 관리한다. 실체 엔터티와의 차이는 존재를 나타내지 않고, 시간이 지남에 따라 자주 변경된자는 점이다. 기준 엔터티를 실체 엔터티로 오해하곤 한다.

## 식별자 상속의 시발점, 종속 엔터티

모든 엔터티를 실체 엔터티, 행위 엔터티, 기준 엔터티, 가공 엔터티로 구분할 수 있다. 이렇게 구분하면 엔터티의 성격을 잘 이해할 수 있다.

**행위 엔터티**는 행위에 의해 발생된 데이터를 관리하는 엔터티이다. 엔터티 중에는 행위 엔터티가 압도적으로 많다. 업무가 대부분 행위에 의해 발생하기 때문이다.

**가공 엔터티**는 원천 데이터가 아닌 데이터를 관리하는 엔터티이다. 집계 엔터티가 대표적이다.

### 종속 엔터티

실체 엔터티인지 판단이 끝나면 자립 엔터티인지 본다. 정확히는 **종속 엔터티인지 확인한다.** 자립 엔터티와 종속 엔터티는 데이터 성격에 따른 구분이 아닌 데이터 간 관계에 따른 구분이다.

**자립 엔터티**는 존재적으로 종속되지 않는 엔터티이다. 예를 들어 주문 엔터티는 고객 엔터티에 관계적으로 종속되지만 존재적으로 종속되지 않는다.

자립 엔터티를 이해하기 위해서는 **종속 엔터티**를 이해하는 게 빠를 수 있다. 주문상품, 변경이력이 대표적인 예이다. 종속 엔터티는 데이터 성격 상 부가 정보를 관리하는 엔터티로 볼 수 있다.

자립 엔터티는 상위 엔터티가 없어지면 매우 중요한 속성(관계 속성)이 없어진다. 반면 종속 엔터티는 상위 엔터티가 없어지면 존재 자체가 의미가 없어진다.

종속 엔터티의 부모 엔터티를 자립 엔터티의 상위 엔터티와 구분할 수 있다.

### 종속 관계

**종속 관계**는 종속 엔터티와 유사하지만 개념이 조금 더 넓다.

관계는 종속 관계와 참조 관계로 구분할 수 있다. 주문과 담당 사원이 참조 관계의 한 예이다. 많은 관계는 이런 참조 관계이다.

어떤 엔터티가 종속 엔터티라면, 그 엔터티와 부모 엔터티의 관계는 종속 관계이다.

종속 관계는 종속 엔터티에 의해 생기거나 업무에 의해 생길 수 있다.

### 식별자를 상속하는 네 가지 방법

종속 엔터티를 판단하는 것은 엔터티의 성격을 명확하게 한다. 종속 관계를 판단하는 것은 관계의 성격을 명확하게 한다. 이 두 개념은 주 식별자에도 막대한 영향을 미친다.

한 엔터티의 주 식별자를 하위 엔터티에 주 식별자로 상속하면 **식별 관계**, 일반 속성으로 상속하면 **비식별 관계**이다.

**두 엔터티가 종속 관계일 때는 식별 관계로 설계하고, 참조 관계일 때는 비식별 관계로 설계한다.** 참조 관계인데 식별 관계로 상속하는 매우 잘못된 설계이다.

![종속성과 상속 관계](https://github.com/autroshot/studyroom/assets/95019875/778572de-59f0-4ebc-9db6-5e17b054ca40)

## 모델링의 꽃, 데이터 정규화

어떤 속성이 엔터티에 속하는지 판단하는 게 정규화이다.

### 정규화의 이점

- 정규화의 가장 커다란 목적 중 하나는 중복 데이터를 제거하는 것이다. 중복 데이터가 없다면 아노말리가 생기지 않는다.
- 모델의 확장성이 좋아진다.
- 데이터 저장 공간의 사용을 최소화한다. 시스템 비용을 줄이고 성능도 좋아진다.

### 함수 종속

**함수 종속**은 데이터 종속성을 의미하며 릴레이션 내에 존재하는 속성 간의 종속성을 말한다. 한 속성의 값을 알면 다른 속성의 값이 결정된다. 두 속성 사이의 일종의 제약이다. 함수 종속을 분석한다는 것은 각 속성의 의미와 업무 요건을 정확히 이해한다는 것을 의미한다.

속성 사이의 종속성을 분석할 때 기준이 되는 값을 **결정자(determinant)**라고 하고, 결정자의 값에 의해 정해지는 값을 **종속자(dependent)**라고 한다.

결정자 속성과 종속자 속성은 하나의 엔터티에 존재해야 한다. 이렇게 만드는 과정이 **정규화(normalization)**이다. 그리고 정규화가 끝난 엔터티를 **정규형(normal form)** 엔터티라고 부른다.

### 아노말리

**아노말리**는 데이터가 서로 맞지 않는 데이터의 이상 현상이다. 아노말리는 중복 데이터가 없으면 발생하지 않는다.

### 정규화

정규화 부분은 기존 정리를 참고한다.

## 식별자: 업무 식별자와 인조 식별자, 주 식별자

주 식별자는 설계하는 방법은 간단하다. 업무 식별자를 도출하고, 그 업무 식별자가 주 식별자로 사용되기에 적절하지 않다면 인조 식별자를 채택한다. 업무 식별자가 주 식별자로 적절하지 않은 경우는 그 엔터티의 하위 엔터티가 많거나, 업무가 변경될 가능성이 있을 때이다. 그리고 암호화 대상인 속성이거나, 길이가 너무 길거나, 값이 변경되면 안 되는 경우가 있다.
