# 문서 수정하기
## 요소 생성하기
DOM 노드를 만들 때 사용하는 메서드는 다음 두 가지이다.

#### `document.createElement(tag)`
태그 이름(`tag`)을 사용해 새로운 요소 노드를 만든다.
```js
let div = document.createElement('div');
```
#### `document.createTextNode(text)`
텍스트(`text`)를 사용해 새로운 텍스트 노드를 만든다.
```js
let textNode = document.createTextNode('안녕하세요.');
```

### 메시지 생성하기
메시지가 들어갈 `div`는 다음과 같이 만들 수 있다.
```js
// 1. <div> 요소 만들기
let div = document.createElement('div');

// 2. 만든 요소의 클래스를 'alert'로 설정
div.className = 'alert';

// 3. 내용 채워넣기
div.innerHTML = '<strong>안녕하세요!</strong> 중요 메시지를 확인하셨습니다.';
```
아직 이 요소는 `div`라는 이름을 가진 변수에 불과하기 때문에 페이지에는 나타나지 않는다.

## 삽입 메서드
요소 삽입 메서드 `append`를 이용해 새로 만든 요소 노드를 페이지에 나타나게 해보겠다.
```html
<script>
  let div = document.createElement('div');
  div.className = 'alert';
  div.innerHTML = '<strong>안녕하세요!</strong> 중요 메시지를 확인하셨습니다.';

  document.body.append(div);
</script>
```
삽입 메서드는 다음과 같다. 원하는 삽입 위치에 따라 메서드를 선택하면 된다.
-   `node.append(노드나 문자열)`: 노드나 문자열을  `node` 끝에 삽입한다.
-   `node.prepend(노드나 문자열)`: 노드나 문자열을  `node` 맨 앞에 삽입한다.
-   `node.before(노드나 문자열)`: 노드나 문자열을  `node` 이전에 삽입한다.
-   `node.after(노드나 문자열)`: 노드나 문자열을  `node` 다음에 삽입한다.
-   `node.replaceWith(노드나 문자열)`:  `node`를 새로운 노드나 문자열로 대체한다.

삽입 메서드의 인수에는 임의의 노드 목록이나 문자열을 넘겨줄 수 있다. 문자열을 넘겨주면 자동으로 텍스트 노드가 만들어진다.

예시:
```html autorun
<ol id="ol">
  <li>0</li>
  <li>1</li>
  <li>2</li>
</ol>

<script>
  ol.before('before'); // <ol> 앞에 문자열 'before'를 삽입한다.
  ol.after('after'); // <ol> 뒤에 문자열 'after를 삽입한다.

  let liFirst = document.createElement('li');
  liFirst.innerHTML = 'prepend';
  ol.prepend(liFirst); // <ol>의 첫 항목으로 liFirst를 삽입한다.

  let liLast = document.createElement('li');
  liLast.innerHTML = 'append';
  ol.append(liLast); // <ol>의 마지막 항목으로 liLast를 삽입한다.
</script>
```
위 예시에서 사용된 메서드들의 역할을 그림으로 표현하면 다음과 같다.

![before-prepend-append-after](https://user-images.githubusercontent.com/95019875/167561021-f4bfdd3d-9d23-4abd-9763-b052812ff378.svg)

이 메서드들을 '복수’의 노드와 문자열을 한 번에 넣을 수 있다.
```html
<div id="div"></div>
<script>
  div.before('<p>안녕하세요</p>', document.createElement('hr'));
</script>
```
위 코드의 결과는 다음과 같다.
```html
&lt;p&gt;안녕하세요&lt;/p&gt;
<hr>
<div id="div"></div>
```
인수로 넘긴 문자열이 'HTML’이 아닌 ‘문자열’ 형태 그대로 삽입된다는 점을 주목해야 한다. 특수문자는 이스케이프 처리된다.

삽입 메서드를 사용하면 문자열은 `elem.textContent`를 사용한 것처럼 **안전하게** 삽입된다.

참고로 요소 노드를 다른 곳으로 옮길 때 기존에 있던 노드를 지울 필요가 없다.

**모든 노드 삽입 메서드는 자동으로 기존에 있던 노드를 삭제하고 새로운 곳으로 노드를 옮기기 때문이다.**

다음은 요소 위치를 바꾸는 예시이다.
```html
<div id="first">First</div>
<div id="second">Second</div>
<script>
  // remove 메서드를 호출할 필요가 없다.
  second.after(first); // id가 second인 노드를 가져오고, 해당 노드의 뒤에 id가 first인 노드를 삽입한다.
</script>
```

## insertAdjacentHTML/Text/Element
HTML 그대로 삽입하려면 메서드 `elem.insertAdjacentHTML(where, html)`를 사용하면 된다.

`elem.insertAdjacentHTML(where, html)`에서 첫 번째 매개변수는 `elem`을 기준으로 하는 상대 위치로, 다음 값 중 하나여야 한다.
-   `'beforebegin'`: `elem`  바로 앞에  `html`을 삽입한다.
-   `'afterbegin'`: `elem`의 첫 번째 자식 요소 바로 앞에  `html`을 삽입한다.
-   `'beforeend'`: `elem`의 마지막 자식 요소 바로 다음에  `html`을 삽입한다.
-   `'afterend'`: `elem`  바로 다음에  `html`을 삽입한다.

두 번째 매개변수는 HTML 문자열로, 이 HTML은 이스케이프 처리되지 않고 ‘그대로’ 삽입된다.
```html
<div id="div"></div>
<script>
  div.insertAdjacentHTML('beforebegin', '<p>안녕하세요.</p>');
  div.insertAdjacentHTML('afterend', '<p>안녕히 가세요.</p>');
</script>
```
위 코드의 결과는 다음과 같다.
```html
<p>안녕하세요.</p>
<div id="div"></div>
<p>안녕히 가세요.</p>
```
다음은 매개변수에 따라 삽입 위치가 어떻게 변하는지를 표현한 그림이다.

![insert-adjacent](https://user-images.githubusercontent.com/95019875/167561042-212ebe9a-e5f2-4994-ba0c-f4274c6f003e.svg)

앞에서 배운 삽입 메서드와 매우 유사하다는 것을 알 수 있다.

`elem.insertAdjacentHTML(where, html)`은 두 가지 형제 메서드가 있다.
-   `elem.insertAdjacentText(where, text)`: `insertAdjacentHTML`과 문법은 같은데, HTML 대신 `text`를 ‘문자 그대로’ 삽입한다는 점이 다르다.
-   `elem.insertAdjacentElement(where, elem)`: 역시 같은 문법인데, 요소를 삽입한다는 점이 다르다.

이 메서드들은 거의 사용하지 않는다. 요소나 문자 노드를 삽입할 때는 `append/prepend/before/after` 메서드를 사용하면 되기 때문이다. 요소 삽입 메서드를 사용하면 코드 길이가 줄어들고, 노드나 텍스트 조각을 쉽게 삽입할 수 있다.


## 노드 삭제하기
`node.remove()` 사용하면 노드를 삭제할 수 있다.

일 초 후 메시지가 사라지게 해보겠다.
```html
<script>
  let div = document.createElement('div');
  div.className = "alert";
  div.innerHTML = '<strong>안녕하세요!</strong> 중요 메시지를 확인하셨습니다.';

  document.body.append(div);
  setTimeout(() => div.remove(), 1000);
</script>
```

## cloneNode로 노드 복제하기
복제하려는 요소가 클 때는 함수를 만드는 대신 복제를 사용하는 방법이 빠르고 간단할 수 있다.

`elem.cloneNode(true)`을 호출하면  `elem`의 ‘깊은’ 복제본이 만들어진다. 속성 전부와 자손 요소 전부가 복사된다.  `elem.cloneNode(false)`을 호출하면 후손 노드 복사 없이  `elem`만 복제된다.

`cloneNode`를 이용해 메시지 창을 하나 더 띄워보겠다.
```html
<div class="alert" id="div">
  <strong>안녕하세요!</strong> 중요 메시지를 확인하셨습니다.
</div>

<script>
  let div2 = div.cloneNode(true); // 메시지 창을 복제한다.
  
  div2.querySelector('strong').innerHTML = '안녕히 가세요!'; // 복제한 메시지 창의 내용을 수정한다.
  div.after(div2); // 복제한 메시지 창을 기존 메시지 창 다음에 보여준다.
</script>
```

## DocumentFragment
`DocumentFragment`는 특별한 DOM 노드 타입으로, 여러 노드로 구성된 그룹을 감싸 다른 곳으로 전달하게 해주는 래퍼(wrapper)처럼 동작한다.

문서에 있는 다른 노드를 `DocumentFragment`에 추가할 수 있는데, `DocumentFragment`를 문서 어딘가에 삽입하면 `DocumentFragment`는 사라지고 `DocumentFragment`에 추가한 노드만 남는다.
```html
<ul id="ul"></ul>

<script>
function getListContent() {
  let fragment = new DocumentFragment();

  for(let i=1; i<=3; i++) {
    let li = document.createElement('li');
    li.append(i);
    fragment.append(li);
  }

  return fragment;
}

ul.append(getListContent());
</script>
```
`DocumentFragment`를 직접 사용할 일은 거의 없다. 다음 예시처럼 노드가 담긴 배열을 직접 만들어 반환할 수 있기 때문이다.
```html
<ul id="ul"></ul>

<script>
function getListContent() {
  let result = [];

  for(let i=1; i<=3; i++) {
    let li = document.createElement('li');
    li.append(i);
    result.push(li);
  }

  return result;
}

ul.append(...getListContent()); // append 메서드와 ...(전개 문법)은 궁합이 잘 맞는다.
</script>
```
[template](https://ko.javascript.info/template-element) 요소 같이 `DocumentFragment`를 기반으로 하는 문법이 있다.

## 구식 삽입·삭제 메서드
---
:warning: **오래된 문법**

이 메서드는 오래된 스크립트에서 볼 수 있다.

---
아주 오래전에 만들어진 이 메서드들은 요즘에는 잘 사용하지 않는다. 앞서 배운 모던한 메서드 `append`, `prepend`, `before`, `after`, `remove`, `replaceWith`를 사용하는 것이 좀 더 유연하기 때문이다.

- `parentElem.appendChild(node)`: `parentElem`의 마지막 자식으로 `node`를 추가한다.
- `parentElem.insertBefore(node, nextSibling)`: `node`를 `parentElem`안의 `nextSibling`앞에 추가한다.
- `parentElem.replaceChild(node, oldChild)`: `parentElem`의 자식 노드 중 `oldChild`를 `node`로 교체한다.
- `parentElem.removeChild(node)`: `node`가 `parentElem`의 자식 노드라는 가정 하에 `parentElem`에서 `node`를 삭제한다.

이 메서드들은 모두 삽입하거나 삭제한 노드를 반환한다. `parentElem.appendChild(node)`는 `node`를 반환한다. 그런데 반환된 값을 사용할 일은 거의 없다.

## 'document.write’에 대한 첨언
`document.write`는 웹페이지에 뭔가를 더할 때 쓰는 아주 오래된 메서드이다.
```html
<p>페이지 어딘가...</p>
<script>
  document.write('<b>자바스크립트를 사용해 Hello 입력</b>');
</script>
<p>끝</p>
```
`document.write(html)`를 호출하면 `html`이 페이지의 그 자리에 즉시 추가된다. `html` 형식의 문자열을 동적으로 만들어 사용할 수 있기 때문에 `document.write(html)`는 꽤나 유연하다.

`document.write`는 큰 문제를 가지고 있다. `document.write`는 페이지를 불러오는 도중에만 작동하기 때문에, 페이지가 다 로드되고 나서 `document.write`를 호출하면 기존에 있던 문서 내용이 사라진다.

장점도 있다. 브라우저는 HTML을 파싱하는 도중에  `document.write(HTML)`를 만나면 텍스트 형식의 HTML을 마치 원래 페이지에 있었던 것 마냥 해석한다. 중간에 DOM 조작을 하지 않기 때문에 속도가 아주 빨라진다. DOM 구조가 완성되기 전에 페이지에 내용이 삽입되기 때문이다.

## 요약
-   노드 생성 메서드:
    -   `document.createElement(tag)`  – 태그 이름을 사용해 새로운 요소를 만듦
    -   `document.createTextNode(value)`  – 텍스트 노드를 만듦(잘 쓰이지 않음)
    -   `elem.cloneNode(deep)`  – 요소를 복제함.  `deep==true`일 경우 모든 자손 요소도 복제됨
-   노드 삽입, 삭제 메서드:
    -   `node.append(노드나 문자열)`  –  `node`  끝에 노드를 삽입
    -   `node.prepend(노드나 문자열)`  –  `node`  맨 앞에 노드를 삽입
    -   `node.before(노드나 문자열)`  –-  `node`  이전에 노드를 삽입
    -   `node.after(노드나 문자열)`  –-  `node`  다음에 노드를 삽입
    -   `node.replaceWith(노드나 문자열)`  –-  `node`를 대체
    -   `node.remove()`  –-  `node`를 제거
    
    문자열을 삽입, 삭제할 땐 문자열을 ‘그대로’ 넣으면 된다.
    
-   ‘구식’ 메서드:
    -   `parent.appendChild(node)`
    -   `parent.insertBefore(node, nextSibling)`
    -   `parent.removeChild(node)`
    -   `parent.replaceChild(newElem, node)`
    
    이 메서드들은 전부  `node`를 반환한다.
    
-   `html`에 HTML을 넣으면 메서드  `elem.insertAdjacentHTML(where, html)`은  `where`  값에 따라 특정 위치에 HTML을 삽입함
    -   `"beforebegin"`  –  `elem`  바로 앞에  `html`을 삽입
    -   `"afterbegin"`  –  `elem`의 첫 번째 자식 요소 바로 앞에  `html`을 삽입
    -   `"beforeend"`  –  `elem`의 마지막 자식 요소 바로 다음에  `html`을 삽입
    -   `"afterend"`  –  `elem`  바로 다음에  `html`을 삽입
    
    문자열이나 요소 삽입에 쓰이는 유사 메서드  `elem.insertAdjacentText`와  `elem.insertAdjacentElement`도 있는데, 잘 쓰이지는 않음
    
-   페이지 로딩이 끝나기 전에 HTML을 삽입해주는 메서드:
    -   `document.write(html)`
    
    문서 로딩이 끝난 상태에서 이 메서드를 호출하면 문서 내용이 지워짐. 오래된 스크립트에서 볼 수 있음
