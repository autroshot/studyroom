# 1장 HTTP 개관

전 세계의 웹브라우저, 서버, 웹 애플리케이션은 모두 HTTP(Hypertext Transfer Protocol)를 통해 서로 대화한다. HTTP는 현대 인터넷의 공용어이다.

## 1. HTTP: 인터넷의 멀티미디어 배달부

HTTP는 데이터가 전송 중에 손상되거나 꼬이지 않음을 보장하는 프로토콜을 사용한다.

## 2. 웹 클라이언트와 서버

웹 서버는 HTTP 프로토콜로 통신하기 때문에 HTTP 서버라고 불린다.

클라이언트는 서버에게 HTTP 요청을 보내고, 서버는 요청된 데이터를 HTTP 응답으로 돌려준다.

## 3. 리소스

웹 서버는 웹 리소스를 관리하고 제공한다. 웹 리소스는 웹 콘텐츠의 원천이다. 가장 간단한 웹 리소스는 정적 파일이다. 텍스트 파일, HTML 파일, 이미지 파일, 동영상 파일 등 모든 종류의 파일이 정적 파일에 포함된다. 동적 리소스의 예로는 카메라의 라이브 영상, 주식 거래, 부동산 정보가 있다.

어떤 콘텐츠 소스도 리소스가 될 수 있다. 스프레드시트 파일, 도서관의 서가를 탐색하는 웹 게이트웨이, 인터넷 검색엔진 모두 리소스이다.

### 미디어 타입

MIME(Multipurpose Internet Mail Extensions, 다목적 인터넷 메일 확장)은 원래 이메일에서 사용되는 포맷이었지만 HTTP에서 채택되었다. 데이터 포맷을 나타낸다.

웹 서버는 모든 HTTP 객체 데이터에 MIME 타입을 붙인다. 클라이언트는 이 타입을 이용하여 받은 데이터를 적절히 처리한다.

MIME 타입은 사선(`/`)으로 구분된 주 타입(primary object type)과 부 타입(specific subtype)으로 이루어진 문자열 라벨이다.

```
type/subtype
```

다음은 MIME 타입의 예시이다.

- `text/plain`
- `text/html`
- `text/css`
- `text/javascript`
- `image/jpeg`
- `image/svg+xml`
- `video/mp4`
- `multipart/form-data`

###  URI

URI(Uniform Resource Identifier, 통합 자원 식별자)는 서버에 있는 리소스의 이름이다. 인터넷의 우편물 주소에 비유할 수 있다.

URI은 URL과 URN로 나뉜다.

### URL

URL(Uniform Resource Locator, 통합 자원 지시자)는 리소스 식별자의 가장 흔한 형태다.

URL은 세 부분으로 이루어진 표준 포맷을 따른다. `http://www.joes-hardware.com/specials/saw-blade.gif`를 예로 들겠다.

1. 스킴(scheme)에서는 프로토콜을 서술 (`http://`)
2. 서버의 주소 (`www.joes-hardware.com`)
3. 리소스의 경로 (`/specials/saw-blade.gif`)

대부분의 URI는 URL 형태이다. 통상적으로 URI와 URL을 같은 의미로 사용한다.

### URN

URN(Uniform Resource Name, 통합 자원 이름)은 리소스의 위치에 영향을 받지 않는 유일한 이름 역할을 한다. 위치 독립적이므로 리소스의 위치가 바뀌어도 문제없다.

다음은 URN의 예시이다.

```
urn:ietf:rfc:2141
```

## 4. 트랜잭션

HTTP 트랜잭션은 요청 명령과 응답 결과로 구성되어 있다.

### 메서드

모든 HTTP 요청 메시지는 한 개의 메서드를 갖는다. 메서드는 서버에게 어떤 동작을 취해야 하는지 말해준다.

다음은 흔히 쓰이는 메서드다.

- GET
- PUT
- DELETE
- POST
- HEAD

### 상태 코드

모든 HTTP 응답 메시지는 상태 코드와 함께 반환된다. 상태 코드는 요청이 성공했는지 추가 조치가 필요한지 알려주는 세 자리 숫자다.

다음은 흔히 쓰이는 상태 코드다.

- 200
- 302
- 404

HTTP는 상태 코드에 '사유 구절(reason phrase)'도 함께 보낸다. 이 구문은 설명만을 위해서 포함될 뿐이다. 실제 응답 처리에는 사용되지 않는다. 예를 들어 다음 상태 코드와 사유 구절은 모두 같은 것으로 취급한다.

```
200 OK
200 Document attached
200 Success
200 All's cool, dude
```

### 웹페이지는 여러 객체로 이루어질 수 있다

웹페이지는 보통 하나의 리소스가 아닌 리소스의 모음이다. 여러 리소스를 가져오기 위해 여러 HTTP 트랜잭션을 수행한다.

먼저 HTML 뼈대를 가져온 뒤, 추가로 HTTP 트랜잭션을 수행하여 이미지, 그래픽 조각, 자바 애플릿 등을 가져온다.

## 5. 메시지

HTTP 메시지는 단순한 줄 단위의 문자열이다. HTTP 메시지는 요청 메시지와 응답 메시지로 분류되며 두 메시지의 형식은 매우 비슷하다.

![http-메시지-구조](https://github.com/autroshot/studyroom/assets/95019875/e9004611-683b-44f2-8084-df79bc6814b8)

메시지는 세 부분으로 나뉜다.

1. 시작줄: 메시지의 첫 줄은 시작줄로, 요청이라면 무엇을 해야 하는지 응답이라면 무슨 일이 일어났는지 나타낸다.
2. 헤더: 각 헤더 필드는 쌍점(`:`)으로 구분되는 이름과 값으로 구성된다. 헤더는 빈 줄로 끝난다.
3. 본문: 빈 줄 다음에는 본문이 따라올 수 있다. 이진 데이터(이미지, 비디오, 응용 소프트웨어)를 비롯한 어떤 데이터든 포함할 수 있다.

## 6. TCP 커넥션

HTTP 메시지는 TCP(Transmission Control Protocol, 전송 제어 프로토콜) 커넥션을 통해 전송된다.

HTTP는 애플리케이션 계층 프로토콜이다. HTTP는 네트워크 통신의 세부사항에 대해서 신경쓰지 않는다. 대신 TCP/IP에게 맡긴다.

TCP는 다음을 제공한다.

- 오류 없는 데이터 전송
- 데이터를 순서에 맞게 전달 (데이터는 보낸 순서대로 도착)
- 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 보낼 수 있음)

TCP 커넥션이 맺어진 후에는 메시지가 없어지거나, 손상되거나, 순서가 뒤바뀌어 수신되는 일이 결코 없다.

다음 세 개의 URL은 같은 주소이다.

```
http://207.200.83.29:80/index.html
http://www.netscape.com:80/index.html
http://www.netscape.com/index.html
```

첫 번째 URL은 IP 주소(`207.200.83.29`)와 포트번호(`80`)를 갖고 있다.

두 번째 URL에는 IP 주소 대신 도메인 이름 혹은 호스트 명(`www.netscape.com`)을 갖고 있다. 호스트 명은 IP 주소에 대한 이해하기 쉬운 별명이다.

세 번째 URL에는 포트번호가 없다. HTTP URL에서 포트번호가 빠진 경우에는 기본값이 `80`이다.

## 7. 프로토콜 버전

### HTTP/0.9

프로토타입으로 GET 메서드만 지원한다. 곧 HTTP/1.0으로 대체되었다.

### HTTP/1.0

널리 쓰이기 시작한 버전이다. 버전 번호, 헤더, 추가 메서드, 멀티미디어 객체 처리가 추가되었다.

### HTTP/1.0+

`keep-alive` 커넥션, 가상 호스팅 지원, 프락시 연결 지원을 포함한 많은 기능이 추가되었다.

### HTTP/1.1

첫 번째 표준화 버전이다. 이전 버전의 구조적 결함 교정, 성능 최적화, 잘못된 기능 제거에 집중했다. 이후에 SSL이라는 암호화된 전송 계층이 추가된다.

### HTTP/2.0

구글의 SPDY 프로토콜을 기반으로 구현되었다. 이전 버전 대비 성능 최적화가 되었다. 이진 프로토콜, 다중화 프로토콜이라는 특징을 가진다. 현재(2024) 전체 요청의 60%로 대부분을 차지한다.

### HTTP/3.0

전송 계층에서 TCP 대신 QUIC를 사용한다. 현재(2024) 전체 요청의 25%를 차지한다.

## 8. 웹의 구성요소

### 프락시

클라이언트와 서버 사이에 위치한 HTTP 중개자이다. 웹 보안, 애플리케이션 통합, 성능 최적화의 역할을 한다.

### 캐시

많이 찾는 웹페이지를 클라이언트 가까이에 보관한다. 일종의 프락시다.

### 게이트웨이

다른 애플리케이션과 연결된 특별한 웹 서버이다. 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다.

### 터널

단순히 HTTP 통신을 전달하기만 하는 특별한 프락시다. 대표적인 예는 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화벽을 통과시키는 것이다.

### 에이전트

사용자 에이전트(혹은 그냥 에이전트)는 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램이다. 웹브라우저는 일종의 에이전트이다. 검색 엔진의 스파이더나 웹로봇은 자동화된 에이전트이다.
