# 데이터베이스 연결하기

데이터베이스를 연결하려면 프리즈마 스키마의 `datasource` 블록의 `url` 필드를 데이터베이스 연결 URL로 설정해야 한다.

```tsx
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
```

`prisma init`으로 생성된 기본 스키마는 PostgreSQL을 `provider`로 사용한다. 플래닛스케일의 경우 공급자로 `mysql`을 사용하도록 `datasource` 블록을 편집해야 한다.

```tsx
datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}
```

또한 `schema.prisma` 파일의 `generator` 파일 블록에 [`referentialIntegrity` 미리보기 기능](https://www.prisma.io/docs/concepts/components/prisma-schema/relations/referential-integrity)을 추가하고 `datasource` 블록에서 참조 무결성 유형 `"prisma"`로 설정해야 한다.

```tsx
generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  referentialIntegrity = "prisma"
}
```

`url`은 `.env`에서 정의된 환경 변수를 통해 다음으로 설정된다.

```tsx
DATABASE_URL="mysql://janedoe:mypassword@server.us-east-2.psdb.cloud/mydb?sslaccept=strict"
```

이제 자신의 데이터베이스를 가리키도록 연결 URL을 조정해야 한다.

데이터베이스의 연결 URL 형식은 일반적으로 사용하는 데이터베이스에 따라 다르다. 플래닛스케일은 다음 구조의 MySQL 연결 URL 형식을 사용한다. (모두 대문자로 표시된 부분은 특정 연결의 세부 정보에 대한 플레이스홀더임)

```
mysql://USER:PASSWORD@HOST:PORT/DATABASE
```

다음은 각 구성 요소에 대한 간단한 설명이다.

- `USER` - 데이터베이스 사용자의 이름
- `PASSWORD` - 데이터베이스 사용자의 비밀번호
- `PORT` - 데이터베이스 서버가 실행되는 포트 (MySQL의 경우에는 일반적으로 `3306`)
- `DATABASE` - 데이터베이스의 이름

플래닛스케일로 호스팅되는 데이터베이스의 경우, 연결 URL은 다음과 비슷하다.

```tsx
DATABASE_URL="mysql://myusername:mypassword@server.us-east-2.psdb.cloud/mydb?sslaccept=strict"
```

지정된 데이터베이스 브랜치에 대한 연결 URL은 브랜치에 대한 개요 페이지로 이동하고 'Connect' 드롭다운을 선택하여 플래닛스케일 계정에서 찾을 수 있다. 'Passwords' 섹션에서 새 비밀번호를 생성하고 'Prisma'를 선택하여 연결 URL에 대한 프리즈마 형식을 가져온다.