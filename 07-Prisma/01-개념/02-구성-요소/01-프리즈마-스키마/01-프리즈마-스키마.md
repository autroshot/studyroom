# 프리즈마 스키마

Prisma 스키마 파일(줄임말: 스키마 파일, Prisma schema, schema )은 Prisma 설정을 위한 기본 설정 파일이다. 일반적으로 `schema.prisma`라고 부르며 다음으로 구성된다.

- **데이터 소스** - Prisma가 연결해야 하는 데이터 소스의 세부 정보를 지정(예: PostgreSQL 데이터베이스)
- **Generators** - 데이터 모델을 기반으로 생성되어야 하는 클라이언트를 지정(예: Prisma Client)
- **데이터 모델 정의** - 앱 모델(데이터 소스별 데이터의 형태)과 그 관계를 지정

자세한 내용은 [Prisma 스키마 API 레퍼런스](https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference)를 참고한다.

`prisma` 명령이 호출될 때마다 CLI는 일반적으로 스키마 파일에서 정보를 읽는다.

다음은 그 예시이다.

- `prisma generate` - Prisma 스키마에서 위에서 언급한 모든 정보를 읽어 올바른 데이터 소스 클라이언트 코드(예: Prisma Client)를 생성
- `prisma migrate dev` - 데이터 소스와 데이터 모델 정의를 읽어 새로운 마이그레이션을 생성

또한 스키마 파일 내의 [환경 변수를 사용](https://www.prisma.io/docs/concepts/components/prisma-schema#accessing-environment-variables-from-the-schema)하여 CLI 명령이 호출될 때 설정 옵션을 제공할 수 있다.

## 예시

다음을 지정하는 Prisma 스키마 파일 예시가 하단에 있다.

- 데이터 소스(PostgreSQL 또는 MongoDB)
- 제너레이터(프리즈마 클라이언트)
- 두 개의 모델(하나의 관계 포함)과 하나의 `enum`이 있는 데이터 모델 정의
- 여러 [기본 데이터 타입 속성](https://www.prisma.io/docs/concepts/components/prisma-schema/data-model#native-type-mapping) (`@db.VarChar(255)`, `@db.ObjectId`)

```tsx
datasource db {
  url      = env("DATABASE_URL")
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  email     String   @unique
  name      String?
  role      Role     @default(USER)
  posts     Post[]
}

model Post {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  published Boolean  @default(false)
  title     String   @db.VarChar(255)
  author    User?    @relation(fields: [authorId], references: [id])
  authorId  Int?
}

enum Role {
  USER
  ADMIN
}
```

## 명명

스키마 파일의 기본 이름은 `schema.prisma`이다. 스키마 파일의 이름이 기본값이면 Prisma CLI는 CLI 명령을 호출한 디렉토리(또는 해당 하위 디렉토리)에서 스키마를 자동으로 감지한다.

파일 이름이 다른 경우 Prisma CLI에 스키마 파일 경로와 함께 `--schema` 인수를 건네줄 수 있다.

예시:

```bash
prisma generate --schema ./database/myschema.prisma
```

